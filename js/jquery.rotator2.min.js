Array.prototype.rotate=function(){var e=Array.prototype.push,h=Array.prototype.splice;return function(j){var a=this.length>>>0;e.apply(this,h.call(this,0,((j>>0)%a+a)%a));return this}}();allowBreakpoints=!1;
(function(e){e.rotator2=function(h,j){var a=this,b;a.$el=e(h);a.$el.data("rotator_link",a);a.currentPage=1;a.timer=null;a.animating=!1;a.playing=!1;a.items=[];a.init=function(){a.options=b=e.extend({},e.rotator2.defaults,j);if(b.blocksChangePerPage>b.blocksPerScreen)b.blocksChangePerPage=b.blocksPerScreen;a.$items=a.$el.find(b.itemsSelector);a.items=a.$items.toArray();a.items_count=a.$items.length;a.containerName="RotatorContainer";a.containerSelector="."+a.containerName;a.after_animate_css={"margin-left":"-100%",
left:0};var c=[];b.prev&&c.push(b.prev);b.next&&c.push(b.next);b.buttons_selector=c.join(", ");if(b.blocksPerScreen>b.items_count)b.blocksPerScreen=a.items_count;if(!e.isFunction(e.easing[b.easing]))b.easing="swing";a.page_count=Math.ceil(a.items_count/b.blocksChangePerPage);a.block_count=Math.ceil(a.items_count/b.blocksPerScreen)+1;a.container_width=400;a.items_width=100/(4*b.blocksPerScreen);a.$items.each(function(a){e(this).data("index",a+1).attr("index",a+1)}).css("width",a.items_width+"%").wrapAll('<div style="width: '+
a.container_width+'%;" class="'+a.containerName+'" />');a.$container=a.$el.children(a.containerSelector);3<a.page_count&&(a.cycleItems(-b.blocksPerScreen),a.$container.find(b.itemsSelector).remove(),a.$container.append(a.items.slice(0,3*b.blocksPerScreen)),a.$container.css({"margin-left":4*-a.items_width*b.blocksPerScreen+"%"}));if(a.items_count<=b.blocksPerScreen)a.$el.addClass("static-rotator"),e(b.buttons_selector).hide(),e(b.navSelector).hide();else{a.buildNextPrevButtons();b.navSelector&&1<a.page_count&&
a.buildNavigation();b.useSwipeTouch&&a.addSwipeTouchListener();b.keyboardNavigation&&a.addKeyboardListener();if(b.autoPlay)a.playing=!0,a.startStop();b.pauseOnHover&&a.addOnHoverListener();b.hashPrefix&&(a.addHashChangeListener(),e(window).trigger("hashchange"))}};a.addHashChangeListener=function(){e(window).bind("hashchange",function(c){c=c.getState(b.hashPrefix,!0)||1;a.animating||a.gotoPage(""+c)})};a.addSwipeTouchListener=function(){e(this).bind({swipeleft:function(){a.animating||a.goNextPage()},
swiperight:function(){a.animating||a.goPrevPage()}})};a.addKeyboardListener=function(){e(document).keydown(function(b){if(a.animating)return!1;37==b.which?a.goPrevPage():39==b.which&&a.goNextPage()})};a.addOnHoverListener=function(){var c=[];c.push(a);b.prev&&c.push(b.prev);b.next&&c.push(b.next);b.navSelector&&c.push(b.navSelector);e(c.join(", ")).hover(function(){a.clearTimer()},function(){a.startStop()})};a.buildNavigation=function(){for(var c=a.page_count,d,g,f=0;f<c;f++){d=[];g=b.blocksChangePerPage;
for(var i=f*g+1;i<(f+1)*g+1;i++)d.push(i);d=e(b.navPageTemplate.replace("$i",f+1)).data("page",f).data("items",d).attr("title","\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u043d\u0430 \u0441\u043b\u0430\u0439\u0434 "+(f+1));b.hashPrefix&&d.attr("href","#"+b.hashPrefix+"="+(f+1));b.navDrawPageNumber&&d.text(f+1);e(b.navSelector).append(d)}e(b.navSelector).find("a").first().addClass("Active");e(b.navSelector).delegate("a","click",function(){if(a.animating||
e(this).hasClass("Active"))return!1;var c=e(this).data("items")[0];e(this).addClass("Active").siblings().removeClass("Active");b.hashPrefix&&a.updateHashUrl(c);a.gotoPage(c);return!1})};a.buildNextPrevButtons=function(){b.hashPrefix&&a.updateNextPrevLinks();a.$el.parent().find(b.buttons_selector).click(function(){a.animating||(e(this).is(b.prev)?a.goPrevPage():a.goNextPage());return!1})};a.startStop=function(){if(!0!==a.playing)a.playing=!1;a.playing?(a.clearTimer(),a.timer=setTimeout(function(){a.animating||
a.goNextPage()},b.delay+b.duration)):a.clearTimer()};a.clearTimer=function(){a.timer&&clearTimeout(a.timer)};a.updateHashUrl=function(a){var d={};d[b.hashPrefix]=a;e.bbq.pushState(d)};a.updateNextPrevLinks=function(){var c=1<a.currentPage?a.currentPage-1:a.items_count,d=a.currentPage<a.items_count?a.currentPage+1:1;e(b.prev).attr("href","#"+b.hashPrefix+"="+c);e(b.next).attr("href","#"+b.hashPrefix+"="+d)};a.loadSlideAndSiblings=function(b){0<b.length&&(a.loadSlide(b),a.loadSlide(b.next()),a.loadSlide(b.prev()))};
a.loadSlide=function(a){if(a){var b=a.attr("loadsrc");b&&e("<img />").attr("src",b).load(function(){a.attr("src",b)})}};a.changeToSlide=function(c){var c=a.$items.eq(c-1).attr("loadsrc"),d=e(".ContentRotatorLoader").show();a.$container.children(b.itemsSelector).first().attr("src",c);d.hide();b.hashPrefix&&a.updateNextPrevLinks();a.animating=!1;if(b.onMoveComplete&&"function"==typeof b.onMoveComplete)b.onMoveComplete(a.currentPage)};a.gotoPage=function(c){if(!(a.animating||a.currentPage==c)){a.animating=
!0;a.clearTimer();var d,g,f=a.$container,i=a.currentPage;f.find(b.itemsSelector).filter(function(){return e(this).data("index")==i});"prev"==c||"next"==c?(g=b.blocksChangePerPage,d="prev"==c,c=parseInt(d?1<i?i-1:a.items_count:i<a.items_count?i+1:1,10)):(c=parseInt(c,10),g=Math.abs(i-c),g=g>a.items_count/2?a.items_count-g:g,d=(i+g)%a.items_count,d=0==d?a.items_count:d,d=d!=c,g==a.items_count/2&&(d=!1));a.nextPage=c;if(d&&g>b.blocksPerScreen){f.find(b.itemsSelector).slice(-b.blocksPerScreen).remove();
a.cycleItems(null,c);c=a.items.slice(b.blocksPerScreen,2*b.blocksPerScreen);if(c.length==b.blocksPerScreen&&(f.prepend(c),c=3*b.blocksPerScreen-f.find(b.itemsSelector).length,0<c&&(console.log(c),f.prepend(a.items.slice(b.blocksPerScreen-c,2*b.blocksPerScreen-c))),allowBreakpoints))debugger;f.css("margin-left","-200%")}else if(!d&&g>2*b.blocksPerScreen-1){if(a.cycleItems(null,c),f.find(b.itemsSelector).slice(0,b.blocksPerScreen).remove(),f.append(a.items.slice(b.blocksPerScreen,2*b.blocksPerScreen)),
f.css("margin-left","0%"),allowBreakpoints)debugger}else if(!d&&g>b.blocksPerScreen&&g<=2*b.blocksPerScreen)a.cycleItems(null,c),c=Math.abs(g)%b.blocksPerScreen,h=-100+(d?-100:100)*(c/b.blocksPerScreen),f.find(b.itemsSelector).slice(0,c).remove(),f.append(a.items.slice(b.blocksPerScreen,2*b.blocksPerScreen)),f.css("margin-left",h+"%");else{var h;a.cycleItems(null,c);h=-100+(d?-100:100)*(g/b.blocksPerScreen);f.find(b.itemsSelector).remove();f.append(a.items.slice(0,3*b.blocksPerScreen));f.css("margin-left",
h+"%");if(allowBreakpoints)debugger}if(b.onBeforeAnimation&&"function"==typeof b.onBeforeAnimation)b.onBeforeAnimation(current_page);a.animateRotator(i,g,d);a.startStop()}};a.animateRotator=function(c,d,e){c=100*Math.min(d,2*b.blocksPerScreen)/b.blocksPerScreen;a.$container.animate({left:(e?"+":"-")+"="+c+"%"},{duration:b.duration,easing:b.easing,complete:function(){a.onAnimationComplete(e,d)}})};a.onAnimationComplete=function(){var c=a.$container,d=e(b.navSelector).find("a");c.find(b.itemsSelector).remove();
var g=a.items.slice(0,3*b.blocksPerScreen);c.append(g).css(a.after_animate_css);a.cycleItems(null,a.nextPage);a.currentPage=a.nextPage;c=a.currentPage;b.navSelector&&d.removeClass("Active").eq(c-1).addClass("Active");b.hashPrefix&&a.updateNextPrevLinks();a.animating=!1;if(b.onMoveComplete&&"function"==typeof b.onMoveComplete)b.onMoveComplete(c)};a.goNextPage=function(){b.hashPrefix&&a.updateHashUrl(a.currentPage<a.items_count?a.currentPage+1:1);a.gotoPage("next")};a.goPrevPage=function(){b.hashPrefix&&
a.updateHashUrl(1<a.currentPage?a.currentPage-1:a.items_count);a.gotoPage("prev")};a.centerOnCurrentSlide=function(){var b=a.currentPage,d=b+3,d=d>a.items_count-1||1>d?Math.abs(a.items_count-Math.abs(d)):d;if(b<d-1||b>d+1)b=3<b?b-3:a.items_count-Math.abs(b-3),a.gotoPage(""+b)};a.cycleItems=function(c,d){if(d){var g=d-e(a.items.slice(b.blocksPerScreen,b.blocksPerScreen+1)).attr("index");a.items.rotate(g)}};a.init()};e.rotator2.defaults={itemsSelector:".RotatorItem",prev:null,next:null,blocksPerScreen:1,
blocksChangePerPage:1,duration:1E3,easing:"swing",navSelector:null,navDrawPageNumber:!1,navPageTemplate:'<a href="#$n"><span>$i</span></a>',keyboardNavigation:!1,onBeforeAnimation:!1,onMoveComplete:!1,autoPlay:!1,delay:6E3,pauseOnHover:!1,useSwipeTouch:!1,hashPrefix:!1,lazyLoad:!1,startPage:1};e.fn.rotator2=function(h){if((typeof h).match("object|undefined"))return this.each(function(){new e.rotator2(this,h)});if(/\d/.test(h)&&!isNaN(h))return this.each(function(){var j=e.data(this,"rotator_link");
if(j){var a="number"==typeof h?h:parseInt(e.trim(h),10);1>a||a>j.items_count||j.gotoPage(a)}})}})(jQuery);
